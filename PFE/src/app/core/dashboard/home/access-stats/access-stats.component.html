<div class="card">
  <h2>Statistiques d'accès par utilisateur</h2>

  <div *ngIf="loading">
    <p>Chargement en cours...</p>
  </div>

  <div *ngIf="!loading && stats.length === 0">
    <p>Aucune statistique d'accès trouvée.</p>
  </div>

  <div *ngIf="stats.length > 0">
    <p-table [value]="stats.slice(0, 5)" [sortField]="sortField" [sortOrder]="sortOrder" (sortFunction)="customSort($event)">
      <ng-template pTemplate="header">
        <tr>
          <th pSortableColumn="FirstName">Prénom <p-sortIcon field="FirstName"></p-sortIcon></th>
          <th pSortableColumn="LastName">Nom de famille <p-sortIcon field="LastName"></p-sortIcon></th>
          <th pSortableColumn="Username">Nom d'utilisateur <p-sortIcon field="Username"></p-sortIcon></th>
          <th pSortableColumn="Email">Email <p-sortIcon field="Email"></p-sortIcon></th>
          <th pSortableColumn="access_count">Nombre d'accès <p-sortIcon field="access_count"></p-sortIcon></th>
          <th pSortableColumn="last_used_at">Date du dernier accès <p-sortIcon field="last_used_at"></p-sortIcon></th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-stat>
        <tr>
          <td>{{ stat.FirstName }}</td>
          <td>{{ stat.LastName }}</td>
          <td>{{ stat.Username }}</td>
          <td>{{ stat.Email }}</td>
          <td>{{ stat.access_count }}</td>
          <td>{{ stat.last_used_at }}</td>
        </tr>
      </ng-template>
    </p-table>
    <div *ngIf="stats.length > 5">
      <button (click)="showMore()">Voir plus</button>
    </div>
  </div>
</div>
